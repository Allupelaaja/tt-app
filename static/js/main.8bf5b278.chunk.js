(this["webpackJsonptt-app"]=this["webpackJsonptt-app"]||[]).push([[0],{146:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(16),c=n.n(i),s=n(81),o=n(72),l={routes:{}};var j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_DATA":return Object.assign({},t,{routes:e.payload});default:return t}},u=Object(o.b)(j),d=n(60),b=n(46),h=n(120),m=n(193),p=n(175),O=n(185),x=n(186),f=n(192),g=n(183),v=n(184),y=n(181),w=n(182),k=n(187),T=n(188),C=n(180),L=n(189),F=n(62),A=n(118),S=n.n(A),D=n(119),N=n.n(D),R=n(45);var B=n(61),M=n.n(B),E=n(87),G=n(111),H=n(190),I=n(179);function P(t){var e=new Date(t),n=e.getHours();n<10&&(n="0"+n);var r=e.getMinutes();return r<10&&(r="0"+r),n+":"+r}var $,q=n(8),z=Object(R.gql)($||($=Object(G.a)(["\n  query Route($fromLat: Float!, $fromLon: Float!) {\n    plan(\n      from: {lat: $fromLat, lon: $fromLon}\n      to: {lat: 60.16736926540844, lon: 24.921782530681504}\n      numItineraries: 5\n    ) {\n      itineraries {\n        startTime\n        endTime\n        duration\n        walkDistance\n        legs {\n          startTime\n          endTime\n          mode\n          duration\n          realTime\n          distance\n          transitLeg\n          from {\n            lat\n            lon\n            name\n            stop {\n              code\n              name\n            }\n          }\n          to {\n            lat\n            lon\n            name\n            stop {\n              code\n              name\n            }\n          }\n          trip {\n            tripHeadsign\n            routeShortName\n          }\n        }\n      }\n    }\n  }"]))),J=Object(p.a)((function(t){return{title:{flexGrow:1,textAlign:"center"},entry:{borderRadius:"25px",margin:"10px"},customBtn:{marginLeft:"5vh"},buttonDiv:{marginBottom:"2vh"}}}));var _=Object(s.b)((function(t){return{routes:t.routes}}))((function(t){var e=t.routes,n=t.setRoute,i=t.setOpen,c=Object(r.useState)(""),s=Object(b.a)(c,2),o=s[0],l=s[1],j=Object(R.useLazyQuery)(z,{onCompleted:function(){store.dispatch(setData(O))}}),u=Object(b.a)(j,2),d=u[0],h=u[1],m=h.loading,p=h.error,O=h.data,x=J();if(m)return Object(q.jsx)("p",{children:"Loading..."});if(p)return Object(q.jsx)("p",{children:"Error :("});function f(){return(f=Object(E.a)(M.a.mark((function t(){var e,n;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:e=t.sent,n=e.features[0].geometry.coordinates,d({variables:{fromLat:n[1],fromLon:n[0]}});case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function v(){return(v=Object(E.a)(M.a.mark((function t(){var e,n;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.digitransit.fi/geocoding/v1/search?text="+o+"&size=1");case 2:return e=t.sent,t.next=5,e.json();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(q.jsxs)("div",{children:[Object(q.jsxs)("div",{className:x.buttonDiv,children:[Object(q.jsx)(H.a,{autoFocus:!0,margin:"dense",type:"string",id:"form-name",label:"Starting address",value:o,onChange:function(t){return l(t.target.value)},inputProps:{maxLength:100}}),Object(q.jsx)(C.a,{className:x.customBtn,variant:"contained",onClick:function(){return function(){return f.apply(this,arguments)}()},children:Object(q.jsx)(F.a,{variant:"h5",children:"Get timetable"})})]}),Object(q.jsx)(F.a,{variant:"h5",className:x.title,children:""!==o?o+" - Maria 01":Object(q.jsx)(q.Fragment,{})}),Object(q.jsx)("br",{}),Object(q.jsx)(I.a,{children:0!=Object.keys(e).length&&e.plan.itineraries.map((function(t,e){return Object(q.jsx)("div",{children:Object(q.jsx)(y.a,{button:!0,className:x.entry,onClick:function(e){return function(t,e){n(e),i(!0)}(0,t)},children:Object(q.jsx)(w.a,{primary:Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(F.a,{variant:"h5",children:"Route - "+(e+1)+" / "+Math.ceil(t.duration/60)+"min"})}),secondary:Object(q.jsx)(a.a.Fragment,{children:Object(q.jsxs)(F.a,{variant:"h5",children:[P(t.startTime),"\xa0 -\xa0",P(t.endTime)]})})})})},e)}))})]})}));window.store=u,window.setData=function(t){return{type:"SET_DATA",payload:t}};var Q=new R.ApolloClient({uri:"https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql",cache:new R.InMemoryCache}),K=a.a.forwardRef((function(t,e){var n=Object(r.useState)("light"),i=Object(b.a)(n,2),c=i[0],s=i[1];u.subscribe((function(){return console.log("state",u.getState())}));var o=Object(h.a)({palette:{type:c}});o=Object(m.a)(o);var l=Object(p.a)((function(t){var e;return{root:{flexGrow:1},title:{flexGrow:1,textAlign:"center"},mainContent:(e={},Object(d.a)(e,t.breakpoints.up("sm"),{width:"75%",margin:"0 auto",padding:"30px",borderRadius:"25px",marginTop:"2vh"}),Object(d.a)(e,"textAlign","center"),Object(d.a)(e,"backgroundColor",o.palette.background.paper),Object(d.a)(e,"minHeight","80vh"),e),entry:{borderRadius:"25px",margin:"10px"},customBtn:{marginLeft:"5vh"},buttonDiv:{marginBottom:"2vh"}}}))(),j=Object(r.useState)(!1),A=Object(b.a)(j,2),D=A[0],B=A[1],M=Object(r.useState)(null),E=Object(b.a)(M,2),G=E[0],H=E[1];function I(){return Object(q.jsxs)(f.a,{onClose:$,"aria-labelledby":"simple-dialog-title",open:D,children:[Object(q.jsx)(g.a,{id:"simple-dialog-title",children:Object(q.jsx)(F.a,{variant:"h5",children:"Route info"})}),Object(q.jsx)(v.a,{children:G?G.legs.map((function(t,e){return Object(q.jsx)("div",{className:l.entry,children:Object(q.jsx)(y.a,{children:Object(q.jsx)(w.a,{primary:Object(q.jsx)(a.a.Fragment,{children:Object(q.jsx)(F.a,{variant:"h5",children:t.mode+(t.trip?" "+t.trip.routeShortName:"")+" - "+Math.ceil(t.duration/60)+"min"})}),secondary:Object(q.jsx)(a.a.Fragment,{children:Object(q.jsxs)(F.a,{variant:"h5",children:[t.from.stop&&t.to.stop?t.from.stop.name+" - "+t.to.stop.name:t.from.name+" - "+t.to.name,Object(q.jsx)("br",{}),P(t.startTime),"\xa0 -\xa0",P(t.endTime)]})})})})},e)})):Object(q.jsx)(q.Fragment,{})})]})}var $=function(){B(!1)};return Object(q.jsx)(R.ApolloProvider,{client:Q,children:Object(q.jsxs)(O.a,{theme:o,children:[Object(q.jsx)(x.a,{}),Object(q.jsxs)("div",{className:"App",children:[Object(q.jsx)(k.a,{position:"static",children:Object(q.jsxs)(T.a,{children:[Object(q.jsx)(F.a,{children:"Aleksi Heikkil\xe4, 2021"}),Object(q.jsx)(F.a,{variant:"h4",className:l.title,children:"Timetables App"}),"light"===c?Object(q.jsx)(C.a,{onClick:function(){return s("dark")},children:Object(q.jsx)(S.a,{})}):Object(q.jsx)(C.a,{onClick:function(){return s("light")},children:Object(q.jsx)(N.a,{})})]})}),Object(q.jsx)("main",{children:Object(q.jsx)(L.a,{className:l.mainContent,children:Object(q.jsxs)("div",{children:[Object(q.jsx)(I,{open:D,onClose:$}),Object(q.jsx)(_,{setRoute:H,setOpen:B})]})})})]})]})})})),U=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,195)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),r(t),a(t),i(t),c(t)}))};c.a.render(Object(q.jsx)(s.a,{store:u,children:Object(q.jsx)(K,{})}),document.getElementById("root")),U()}},[[146,1,2]]]);
//# sourceMappingURL=main.8bf5b278.chunk.js.map